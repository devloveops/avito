<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AvitoLite — Вход через Google</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      background-color: #f5f5f5;
    }
    .card {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      text-align: center;
      max-width: 500px;
      width: 90%;
    }
    h1 {
      color: #333;
      margin-top: 0;
    }
    .btn-google {
      background: #4285f4;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
      transition: background 0.2s;
    }
    .btn-google:hover {
      background: #3367d6;
    }
    .result {
      margin-top: 20px;
      padding: 12px;
      border-radius: 6px;
      display: none;
    }
    .success { background: #e6f4ea; color: #137333; }
    .error { background: #fce8e6; color: #c5221f; }
    textarea {
      width: 100%;
      margin-top: 8px;
      font-size: 12px;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
    }
    .token-section {
      margin: 12px 0;
      text-align: left;
    }
    .token-label {
      font-weight: bold;
      margin-bottom: 4px;
      display: block;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>AvitoLite</h1>
    <p>Войдите через Google, чтобы получить JWT-токен</p>
    
    <a href="http://localhost:5064/login-google" class="btn-google">
      <svg width="20" height="20" viewBox="0 0 24 24" style="margin-right:8px">
        <path fill="#fff" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
      </svg>
      Войти через Google
    </a>

    <div id="result" class="result"></div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get('token');
    const refreshToken = urlParams.get('refreshToken');
    const error = urlParams.get('error');

    const resultDiv = document.getElementById('result');
    
    if (token || refreshToken) {
      let html = '<strong>Успешно!</strong><br>';
      
      if (token) {
        html += `
          <div class="token-section">
            <span class="token-label">Access Token (JWT):</span>
            <textarea rows="3" readonly>${token}</textarea>
          </div>
        `;
      }
      
      if (refreshToken) {
        html += `
          <div class="token-section">
            <span class="token-label">Refresh Token:</span>
            <textarea rows="2" readonly>${refreshToken}</textarea>
          </div>
        `;
      }
      
      html += `
        <p style="margin-top:12px; font-size:14px;">
          Скопируйте токены и используйте в заголовках:<br>
          <code>Authorization: Bearer ваш_access_token</code><br>
          <code>RefreshToken: ваш_refresh_token</code>
        </p>
      `;
      
      resultDiv.className = 'result success';
      resultDiv.innerHTML = html;
      resultDiv.style.display = 'block';

      // Очищаем URL от токенов (без перезагрузки)
      window.history.replaceState({}, document.title, window.location.pathname);
    } 
    else if (error) {
      resultDiv.className = 'result error';
      resultDiv.textContent = 'Ошибка: ' + decodeURIComponent(error);
      resultDiv.style.display = 'block';
    }
  </script>
</body>
</html>